{"version":3,"file":"dashboard.element-BHki1R0v.js","sources":["../../../Client/src/extensions/hidden-content-registry.service.ts","../../../Client/src/dashboards/hidden-content-section.element.ts","../../../Client/src/dashboards/dashboard.element.ts"],"sourcesContent":["import { UmbControllerBase } from \"@umbraco-cms/backoffice/class-api\";\r\nimport type { UmbControllerHost } from \"@umbraco-cms/backoffice/controller-api\";\r\nimport { umbExtensionsRegistry } from \"@umbraco-cms/backoffice/extension-registry\";\r\nimport type { ManifestHiddenContent, HiddenContentExtension } from \"./hidden-content.manifest.js\";\r\nimport { UmbArrayState } from \"@umbraco-cms/backoffice/observable-api\";\r\n\r\nexport class HiddenContentRegistryService extends UmbControllerBase {\r\n  #extensions = new UmbArrayState<HiddenContentExtension>([], (x) => x.alias);\r\n\r\n  public readonly extensions = this.#extensions.asObservable();\r\n\r\n  constructor(host: UmbControllerHost) {\r\n    super(host);\r\n    \r\n    // Observe the global extension registry for hiddenContent type extensions\r\n    this.observe(\r\n      umbExtensionsRegistry.byType(\"hiddenContent\"),\r\n      (manifests) => {\r\n        this.#updateExtensions(manifests as Array<ManifestHiddenContent>);\r\n      },\r\n      \"observeHiddenContentExtensions\"\r\n    );\r\n  }\r\n\r\n  #updateExtensions(manifests: Array<ManifestHiddenContent>) {\r\n    const extensions: HiddenContentExtension[] = manifests.map((manifest) => ({\r\n      alias: manifest.alias,\r\n      name: manifest.name,\r\n      label: manifest.meta.label,\r\n      description: manifest.meta.description,\r\n      icon: manifest.meta.icon || \"icon-box\",\r\n      pathname: manifest.meta.pathname,\r\n      elementLoader: manifest.element,\r\n    }));\r\n\r\n    this.#extensions.setValue(extensions);\r\n  }\r\n\r\n  getExtensions(): Array<HiddenContentExtension> {\r\n    return this.#extensions.value;\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nlet instance: HiddenContentRegistryService | null = null;\r\n\r\nexport function getHiddenContentRegistry(host: UmbControllerHost): HiddenContentRegistryService {\r\n  if (!instance) {\r\n    instance = new HiddenContentRegistryService(host);\r\n  }\r\n  return instance;\r\n}\r\n","import {\r\n  LitElement,\r\n  css,\r\n  html,\r\n  customElement,\r\n  state,\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport { getHiddenContentRegistry } from \"../extensions/hidden-content-registry.service.js\";\r\nimport type { HiddenContentExtension } from \"../extensions/hidden-content.manifest.js\";\r\nimport { getHiddenDashboardConfig } from \"../config/config.service.js\";\r\nimport type { HiddenDashboardConfig } from \"../config/config.interface.js\";\r\n\r\n@customElement(\"oc-hidden-content-section\")\r\nexport class HiddenContentSectionElement extends UmbElementMixin(LitElement) {\r\n  @state()\r\n  private _extensions: Array<HiddenContentExtension> = [];\r\n\r\n  @state()\r\n  private _filteredExtensions: Array<HiddenContentExtension> = [];\r\n\r\n  @state()\r\n  private _config?: HiddenDashboardConfig;\r\n\r\n  @state()\r\n  private _selectedExtension?: HiddenContentExtension;\r\n\r\n  @state()\r\n  private _loadedElement?: HTMLElement;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    const registry = getHiddenContentRegistry(this);\r\n    const configService = getHiddenDashboardConfig(this);\r\n    \r\n    this.observe(\r\n      registry.extensions,\r\n      (extensions) => {\r\n        this._extensions = extensions;\r\n        this._filterExtensions();\r\n      },\r\n      \"_observeExtensions\"\r\n    );\r\n\r\n    this.observe(\r\n      configService.config,\r\n      (config) => {\r\n        this._config = config;\r\n        this._filterExtensions();\r\n      },\r\n      \"_observeConfig\"\r\n    );\r\n  }\r\n\r\n  private _filterExtensions() {\r\n    if (!this._config) {\r\n      this._filteredExtensions = this._extensions;\r\n      return;\r\n    }\r\n\r\n    this._filteredExtensions = this._extensions.filter((ext) => {\r\n      // Check if it's an example extension\r\n      const isExampleExtension = \r\n        ext.alias.startsWith(\"OC.HiddenDashboard.\") && \r\n        (ext.alias.includes(\"Example\") || ext.alias.includes(\"Pacman\"));\r\n\r\n      if (isExampleExtension) {\r\n        // Check if example extensions are disabled globally\r\n        if (!this._config!.showExampleExtensions) {\r\n          return false;\r\n        }\r\n        \r\n        // Check if this specific extension is in the disabled list\r\n        if (this._config!.disabledExampleExtensions.includes(ext.alias)) {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      return true;\r\n    });\r\n\r\n    // Auto-select first extension if available and current selection is filtered out\r\n    if (this._filteredExtensions.length > 0) {\r\n      if (!this._selectedExtension || !this._filteredExtensions.includes(this._selectedExtension)) {\r\n        this._selectExtension(this._filteredExtensions[0]);\r\n      }\r\n    } else {\r\n      this._selectedExtension = undefined;\r\n      this._loadedElement = undefined;\r\n    }\r\n  }\r\n\r\n  async _selectExtension(extension: HiddenContentExtension) {\r\n    this._selectedExtension = extension;\r\n    this._loadedElement = undefined;\r\n\r\n    try {\r\n      const module = await extension.elementLoader();\r\n      const ElementClass = module.default || module[Object.keys(module)[0]];\r\n      \r\n      if (ElementClass) {\r\n        this._loadedElement = new ElementClass();\r\n      }\r\n    } catch (error) {\r\n      console.error(`Failed to load extension element for ${extension.alias}:`, error);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this._filteredExtensions.length === 0) {\r\n      return html`\r\n        <uui-box>\r\n          <div slot=\"header\">ðŸŽ® Hidden Content</div>\r\n          <p>${this._config?.noExtensionsMessage || \"No hidden content extensions registered yet.\"}</p>\r\n          ${this._config?.showExtensibilityHint !== false\r\n            ? html`<p><i>Third-party packages can register their hidden content here!</i></p>`\r\n            : \"\"}\r\n        </uui-box>\r\n      `;\r\n    }\r\n\r\n    return html`\r\n      <div class=\"hidden-content-container\">\r\n        <div class=\"sidebar\">\r\n          <h3>ðŸŽ® Hidden Extensions</h3>\r\n          <ul class=\"extension-list\">\r\n            ${this._filteredExtensions.map(\r\n              (ext) => html`\r\n                <li>\r\n                  <uui-button\r\n                    look=\"${this._selectedExtension?.alias === ext.alias\r\n                      ? 'primary'\r\n                      : 'secondary'}\"\r\n                    label=\"${ext.label}\"\r\n                    @click=\"${() => this._selectExtension(ext)}\"\r\n                    compact\r\n                  >\r\n                    <uui-icon name=\"${ext.icon || 'icon-box'}\"></uui-icon>\r\n                    ${ext.label}\r\n                  </uui-button>\r\n                </li>\r\n              `\r\n            )}\r\n          </ul>\r\n        </div>\r\n        \r\n        <div class=\"content-area\">\r\n          ${this._selectedExtension\r\n            ? html`\r\n                <uui-box>\r\n                  <div slot=\"header\">\r\n                    <uui-icon name=\"${this._selectedExtension.icon || 'icon-box'}\"></uui-icon>\r\n                    ${this._selectedExtension.label}\r\n                  </div>\r\n                  ${this._selectedExtension.description\r\n                    ? html`<p class=\"description\">${this._selectedExtension.description}</p>`\r\n                    : \"\"}\r\n                  ${this._loadedElement\r\n                    ? html`<div class=\"extension-content\">${this._loadedElement}</div>`\r\n                    : html`<p>Loading...</p>`}\r\n                </uui-box>\r\n              `\r\n            : html`<p>Select an extension to view its content.</p>`}\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  static styles = [\r\n    css`\r\n      :host {\r\n        display: block;\r\n      }\r\n\r\n      .hidden-content-container {\r\n        display: grid;\r\n        grid-template-columns: 250px 1fr;\r\n        gap: var(--uui-size-layout-1);\r\n      }\r\n\r\n      .sidebar {\r\n        background: var(--uui-color-surface);\r\n        border-radius: var(--uui-border-radius);\r\n        padding: var(--uui-size-space-4);\r\n      }\r\n\r\n      .sidebar h3 {\r\n        margin: 0 0 var(--uui-size-space-4) 0;\r\n        font-size: var(--uui-type-h5-size);\r\n      }\r\n\r\n      .extension-list {\r\n        list-style: none;\r\n        padding: 0;\r\n        margin: 0;\r\n      }\r\n\r\n      .extension-list li {\r\n        margin-bottom: var(--uui-size-space-2);\r\n      }\r\n\r\n      .extension-list uui-button {\r\n        width: 100%;\r\n        justify-content: flex-start;\r\n      }\r\n\r\n      .content-area {\r\n        min-height: 200px;\r\n      }\r\n\r\n      .description {\r\n        color: var(--uui-color-text-alt);\r\n        font-style: italic;\r\n      }\r\n\r\n      .extension-content {\r\n        margin-top: var(--uui-size-space-4);\r\n      }\r\n\r\n      @media (max-width: 768px) {\r\n        .hidden-content-container {\r\n          grid-template-columns: 1fr;\r\n        }\r\n      }\r\n    `,\r\n  ];\r\n}\r\n\r\nexport default HiddenContentSectionElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"oc-hidden-content-section\": HiddenContentSectionElement;\r\n  }\r\n}\r\n","import {\r\n  LitElement,\r\n  css,\r\n  html,\r\n  customElement,\r\n  state,\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport \"./hidden-content-section.element.js\";\r\nimport { getHiddenDashboardConfig } from \"../config/config.service.js\";\r\nimport type { HiddenDashboardConfig } from \"../config/config.interface.js\";\r\n\r\n@customElement(\"example-dashboard\")\r\nexport class ExampleDashboardElement extends UmbElementMixin(LitElement) {\r\n  @state()\r\n  private _config?: HiddenDashboardConfig;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    const configService = getHiddenDashboardConfig(this);\r\n    this.observe(\r\n      configService.config,\r\n      (config) => {\r\n        this._config = config;\r\n      },\r\n      \"_observeConfig\"\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const title = this._config?.dashboardTitle || \"Hidden Dashboard\";\r\n\r\n    return html`\r\n      <div class=\"dashboard-header\">\r\n        <h1>ðŸŽ® ${title}</h1>\r\n      </div>\r\n      <oc-hidden-content-section class=\"wide\"></oc-hidden-content-section>\r\n    `;\r\n  }\r\n\r\n  static styles = [\r\n    css`\r\n      :host {\r\n        display: grid;\r\n        gap: var(--uui-size-layout-1);\r\n        padding: var(--uui-size-layout-1);\r\n        grid-template-columns: 1fr 1fr 1fr;\r\n      }\r\n\r\n      .dashboard-header {\r\n        grid-column: span 3;\r\n        text-align: center;\r\n        padding: var(--uui-size-space-4) 0;\r\n      }\r\n\r\n      .dashboard-header h1 {\r\n        margin: 0;\r\n        color: var(--uui-color-primary);\r\n        font-size: 2.5em;\r\n        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\r\n      }\r\n\r\n      uui-box {\r\n        margin-bottom: var(--uui-size-layout-1);\r\n      }\r\n\r\n      h2 {\r\n        margin-top: 0;\r\n      }\r\n\r\n      .wide {\r\n        grid-column: span 3;\r\n      }\r\n    `,\r\n  ];\r\n}\r\n\r\nexport default ExampleDashboardElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"example-dashboard\": ExampleDashboardElement;\r\n  }\r\n}\r\n"],"names":["HiddenContentRegistryService","UmbControllerBase","host","#extensions","UmbArrayState","x","umbExtensionsRegistry","manifests","#updateExtensions","extensions","manifest","instance","getHiddenContentRegistry","HiddenContentSectionElement","UmbElementMixin","LitElement","registry","configService","getHiddenDashboardConfig","config","ext","extension","module","ElementClass","error","html","css","__decorateClass","state","customElement","ExampleDashboardElement","title","ExampleDashboardElement_default"],"mappings":"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"}