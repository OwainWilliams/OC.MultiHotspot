{"version":3,"file":"config.service-U1CJjH1k.js","sources":["../../../Client/src/config/config.interface.ts","../../../Client/src/config/config.service.ts"],"sourcesContent":["export interface HiddenDashboardConfig {\r\n  dashboardTitle: string;\r\n  keySequence: string[];\r\n  showExampleExtensions: boolean;\r\n  disabledExampleExtensions: string[];\r\n  noExtensionsMessage: string;\r\n  showExtensibilityHint: boolean;\r\n}\r\n\r\nexport const DEFAULT_CONFIG: HiddenDashboardConfig = {\r\n  dashboardTitle: \"Hidden Dashboard\",\r\n  keySequence: [],\r\n  showExampleExtensions: true,\r\n  disabledExampleExtensions: [],\r\n  noExtensionsMessage: \"No hidden content extensions registered yet.\",\r\n  showExtensibilityHint: true,\r\n};\r\n","import { UmbControllerBase } from \"@umbraco-cms/backoffice/class-api\";\r\nimport type { UmbControllerHost } from \"@umbraco-cms/backoffice/controller-api\";\r\nimport { UmbObjectState } from \"@umbraco-cms/backoffice/observable-api\";\r\nimport { type HiddenDashboardConfig, DEFAULT_CONFIG } from \"./config.interface.js\";\r\n\r\nexport class HiddenDashboardConfigService extends UmbControllerBase {\r\n  #config = new UmbObjectState<HiddenDashboardConfig>(DEFAULT_CONFIG);\r\n  public readonly config = this.#config.asObservable();\r\n\r\n  constructor(host: UmbControllerHost) {\r\n    super(host);\r\n    this.#loadConfig();\r\n  }\r\n\r\n  async #loadConfig() {\r\n    try {\r\n      const response = await fetch(\"/umbraco/ochiddendashboard/api/v1/config\", {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        credentials: \"include\",\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const config = await response.json();\r\n        this.#config.setValue(config);\r\n      }\r\n    } catch (error) {\r\n      // Silently fall back to default config\r\n    }\r\n  }\r\n\r\n  getConfig(): HiddenDashboardConfig {\r\n    return this.#config.value;\r\n  }\r\n\r\n  isExtensionEnabled(alias: string): boolean {\r\n    const config = this.#config.value;\r\n    \r\n    // Check if it's an example extension\r\n    const isExampleExtension = \r\n      alias.startsWith(\"OC.HiddenDashboard.\") && \r\n      (alias.includes(\"Example\") || alias.includes(\"Pacman\"));\r\n\r\n    if (isExampleExtension) {\r\n      if (!config.showExampleExtensions) {\r\n        return false;\r\n      }\r\n      \r\n      if (config.disabledExampleExtensions.includes(alias)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nlet instance: HiddenDashboardConfigService | null = null;\r\n\r\nexport function getHiddenDashboardConfig(host: UmbControllerHost): HiddenDashboardConfigService {\r\n  if (!instance) {\r\n    instance = new HiddenDashboardConfigService(host);\r\n  }\r\n  return instance;\r\n}\r\n"],"names":["DEFAULT_CONFIG","HiddenDashboardConfigService","UmbControllerBase","host","#config","UmbObjectState","#loadConfig","response","config","alias","instance","getHiddenDashboardConfig"],"mappings":";;AASO,MAAMA,IAAwC;AAAA,EACnD,gBAAgB;AAAA,EAChB,aAAa,CAAA;AAAA,EACb,uBAAuB;AAAA,EACvB,2BAA2B,CAAA;AAAA,EAC3B,qBAAqB;AAAA,EACrB,uBAAuB;AACzB;ACXO,MAAMC,UAAqCC,EAAkB;AAAA,EAIlE,YAAYC,GAAyB;AACnC,UAAMA,CAAI,GAJZ,KAAAC,KAAU,IAAIC,EAAsCL,CAAc,GAClE,KAAgB,SAAS,KAAKI,GAAQ,aAAA,GAIpC,KAAKE,GAAA;AAAA,EACP;AAAA,EANAF;AAAA,EAQA,MAAME,KAAc;AAClB,QAAI;AACF,YAAMC,IAAW,MAAM,MAAM,4CAA4C;AAAA,QACvE,SAAS;AAAA,UACP,gBAAgB;AAAA,QAAA;AAAA,QAElB,aAAa;AAAA,MAAA,CACd;AAED,UAAIA,EAAS,IAAI;AACf,cAAMC,IAAS,MAAMD,EAAS,KAAA;AAC9B,aAAKH,GAAQ,SAASI,CAAM;AAAA,MAC9B;AAAA,IACF,QAAgB;AAAA,IAEhB;AAAA,EACF;AAAA,EAEA,YAAmC;AACjC,WAAO,KAAKJ,GAAQ;AAAA,EACtB;AAAA,EAEA,mBAAmBK,GAAwB;AACzC,UAAMD,IAAS,KAAKJ,GAAQ;AAO5B,WAAI,EAHFK,EAAM,WAAW,qBAAqB,MACrCA,EAAM,SAAS,SAAS,KAAKA,EAAM,SAAS,QAAQ,OAGjD,CAACD,EAAO,yBAIRA,EAAO,0BAA0B,SAASC,CAAK;AAAA,EAMvD;AACF;AAGA,IAAIC,IAAgD;AAE7C,SAASC,EAAyBR,GAAuD;AAC9F,SAAKO,MACHA,IAAW,IAAIT,EAA6BE,CAAI,IAE3CO;AACT;"}